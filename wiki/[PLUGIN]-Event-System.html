<!DOCTYPE html>
<html class="no-js">
<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="title" content="Event-System - PhileCMS">
  <meta property="og:title" content="Event-System - PhileCMS">
  <meta name="description" content="PhileCMS - the flat-file PHP CMS">
  <meta itemprop="description" content="Event-System - PhileCMS - the flat-file PHP CMS">
  <meta property="og:description" content="Event-System - PhileCMS - the flat-file PHP CMS">
  <meta itemprop="url" content="http://philecms.github.io/">
  <meta property="og:url" content="http://philecms.github.io/">
  <meta property="og:site_name" content="PhileCMS">
  <meta property="article:author" content="PhileCMS" />
  <meta itemprop="image logo" content="../img/phile-logo.png">
  <meta property="og:image" content="../img/phile-logo.png">
  <link href='//fonts.googleapis.com/css?family=Lato:300,400,900' rel='stylesheet' type='text/css'>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.min.css" media="screen" />
  <!--[if IE]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <title>Event-System - Flat-File PHP CMS - PhileCMS</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="home-page">

<nav class="top-menu section-1">
  <div class="grid">
    <div class="col-1-3 top-menu-hero">
      <p>
        <a href="../index.html">
          <img src="../img/phile-logo.svg" alt="phile-logo">
        </a>
        <span id="pageTitle">
            <a href="">
              Event-System
            </a>
        </span>
      </p>
    </div>
    <div class="col-2-3 top-menu-nav right">
      <ul>
        <li>
          <a href="../index.html" class="">
            <i class="fa fa-home"></i>
            PhileCMS
          </a>
        </li>
        <li>
          <a href="../wiki/Home.html" class="item-active">
            <i class="fa fa-book"></i>
            Docs
          </a>
        </li>
        <li>
          <a href="../api/">
            <i class="fa fa-sitemap"></i>
            PhpDoc 
          </a>
        </li>
        <li>
          <a href="https://github.com/PhileCMS/Phile">
            <i class="fa fa-github"></i>
            Source
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="grid">
      <section id="main_content">

        <div class="col-1-4">
          <aside class="wiki-aside">
            <h2>Navigation</h2>
<ul>
<li><a href='Home.html'>Home</a></li>
</ul>
<h3>How-To</h3>
<ul>
<li><a href='%5BHOW-TO%5D-Installation.html'>Installation</a></li>
<li><a href='%5BHOW-TO%5D-Configuration.html'>Configuration</a></li>
<li><a href='%5BHOW-TO%5D-Updating.html'>Updating</a></li>
<li><a href='%5BHOW-TO%5D-How-To-Blog.html'>How-To Blog</a></li>
<li><a href='%5BHOW-TO%5D-Pagination.html'>Pagination</a></li>
<li><a href='%5BHOW-TO%5D-Using-Nginx-with-Phile.html'>Using Nginx</a></li>
</ul>
<h3>Community</h3>
<ul>
<li><a href='%5BCOMMUNITY%5D-Sites-using-Phile.html'>Sites using Phile</a></li>
<li><a href='%5BCOMMUNITY%5D-Plugins.html'>Plugins</a></li>
<li><a href='%5BCOMMUNITY%5D-Themes.html'>Themes</a></li>
</ul>
<h3>Plugin-Development</h3>
<ul>
<li><a href='%5BPLUGIN%5D-Plugins.html'>Plugins</a></li>
<li><a href='%5BPLUGIN%5D-Event-System.html'>Event-System</a></li>
<li><a href='%5BPLUGIN%5D-Service-Locator.html'>Service-Locator</a></li>
<li><a href='%5BPLUGIN%5D-Use-Core-Classes.html'>Use Core Classes</a></li>
<li><a href='%5BPLUGIN%5D-Best-Practice.html'>Best Practice</a></li>
<li><a href='%5BPLUGIN%5D-Publish-A-Plugin.html'>Publish</a></li>
</ul>
<h3>Core-Development</h3>
<ul>
<li><a href='%5BDEVELOPER%5D-Introduction.html'>Introduction</a></li>
<li><a href='%5BDEVELOPER%5D-Developer-Guidelines.html'>Developer-Guidelines</a></li>
<li><a href='%5BDEVELOPER%5D-Release-Guide.html'>Release Guide</a></li>
</ul>          </aside>
        </div>

        <div class="col-3-4">
                      <div class="toc">
              <h2>Table of Contents</h2>
              <ul>
  <li class="first">
    <a href="#the-basics">The Basics</a>
  </li>
  <li>
    <a href="#subscribing-to-events">Subscribing to Events</a>
  </li>
  <li>
    <a href="#choosing-the-right-event">Choosing the Right Event</a>
  </li>
  <li class="last">
    <a href="#list-of-events">List of Events</a>
    <ul class="menu_level_1">
      <li class="first">
        <a href="#plugins-loaded">plugins_loaded</a>
      </li>
      <li>
        <a href="#config-loaded">config_loaded</a>
      </li>
      <li>
        <a href="#after-init-core">after_init_core</a>
      </li>
      <li>
        <a href="#request-uri">request_uri</a>
      </li>
      <li>
        <a href="#after-404">after_404</a>
      </li>
      <li>
        <a href="#after-resolve-page">after_resolve_page</a>
      </li>
      <li>
        <a href="#before-init-template">before_init_template</a>
      </li>
      <li>
        <a href="#before-render-template">before_render_template</a>
      </li>
      <li>
        <a href="#template-engine-registered">template_engine_registered</a>
      </li>
      <li>
        <a href="#after-render-template">after_render_template</a>
      </li>
      <li>
        <a href="#after-response-created">after_response_created</a>
      </li>
      <li>
        <a href="#before-read-file-meta">before_read_file_meta</a>
      </li>
      <li>
        <a href="#after-read-file-meta">after_read_file_meta</a>
      </li>
      <li>
        <a href="#before-load-content">before_load_content</a>
      </li>
      <li>
        <a href="#after-load-content">after_load_content</a>
      </li>
      <li>
        <a href="#before-parse-content">before_parse_content</a>
      </li>
      <li class="last">
        <a href="#after-parse-content">after_parse_content</a>
      </li>
    </ul>
  </li>
</ul>

            </div>
          
          
<h1 id="the-event-system">The Event System</h1>
<h2 id="the-basics">The Basics</h2>
<p>One of the main feature of Phile is new event system, which replace the hook system of pico.</p>
<p>In the core Phile triggers a lot of events, and for every event you can register your plugin to get informed. Depending on the event data is passed along and can be manipulated by the plugin.</p>
<h2 id="subscribing-to-events">Subscribing to Events</h2>
<p>The easiest way to subscribe to events is using the <code>$events</code> property in your plugin:</p>
<pre><code class="language-php">class Plugin extends \Phile\Plugin\AbstractPlugin {

    protected $events = ['after_load_content' =&gt; 'doStuff'];

    protected function doStuff($eventData) {
        // do stuff on the "after_load_content"-event
    }
}</code></pre>
<h2 id="choosing-the-right-event">Choosing the Right Event</h2>
<p>A plugin may subsribe to one or multiple events.  Plug-ins should consider when they do what. The two major stages in Phile are:</p>
<ol>
<li>Bootstrap the environment (load configs, load plugins, populate services).</li>
<li>Process request into response (evaluate incoming request, find content, render content, serve response).</li>
</ol>
<p>As a rule of thumb:</p>
<p>If a plugin <em>provides facilities</em> to the core (e.g. implements a  ServiceLocator), then it probably wants to register its functionality during the bootstrap stage (e.g. <code>plugins_loaded</code> event). The bootstrap phase <em>should not create or send output</em>.</p>
<p>The more common case is that a plugin <em>requires facilities</em> from the core (current page, template engine) to <em>create or manipulate output</em>. This  should be done in events during the processing phase.</p>
<h2 id="list-of-events">List of Events</h2>
<p>In the core we trigger a lot of events, which help to manipulate content or other stuff within a plugin.
To use the event system, you only have to register your plugin for a specific event, look at the example plugin for more an example.</p>
<p>The following list shows all events.</p>
<h3 id="plugins-loaded">plugins_loaded</h3>
<p>this event is triggered after the plugins loaded</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>plugins</code></td>
<td style="text-align: left;">array</td>
<td style="text-align: left;"><code>Plugin</code> classes of all loaded plugins</td>
</tr>
</tbody>
</table>
<h3 id="config-loaded">config_loaded</h3>
<p>this event is triggered after the configuration is fully loaded</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>config</code></td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">the complete configuration</td>
</tr>
</tbody>
</table>
<h3 id="after-init-core">after_init_core</h3>
<p>this event is triggered after the core is initialized</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response</code></td>
<td style="text-align: left;">\Phile\Core\Response</td>
<td style="text-align: left;">the response, set a PSR-7 response to send output early</td>
</tr>
</tbody>
</table>
<h3 id="request-uri">request_uri</h3>
<p>this event is triggered after the request uri is detected.</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uri</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the requested uri (without install_path)</td>
</tr>
<tr>
<td><code>response</code></td>
<td style="text-align: left;">Psr\Http\Message\ResponseInterface</td>
<td style="text-align: left;">set a PSR-7 response to send output early</td>
</tr>
</tbody>
</table>
<h3 id="after-404">after_404</h3>
<p>this event is triggered after a requested page is not found</p>
<h3 id="after-resolve-page">after_resolve_page</h3>
<p>this event is triggered after a request is resolved to a page</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pageId</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the requested page-ID</td>
</tr>
<tr>
<td><code>page</code></td>
<td style="text-align: left;">Phile\Model\Page</td>
<td style="text-align: left;">the page served</td>
</tr>
<tr>
<td><code>response</code></td>
<td style="text-align: left;">Psr\Http\Message\ResponseInterface</td>
<td style="text-align: left;">set a PSR-7 response to send output early</td>
</tr>
</tbody>
</table>
<h3 id="before-init-template">before_init_template</h3>
<p>this event is triggered before the the template engine is init</p>
<h3 id="before-render-template">before_render_template</h3>
<p>this event is triggered before the template is rendered</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>templateEngine</code></td>
<td style="text-align: left;">\Phile\Template\TemplateInterface</td>
<td style="text-align: left;">the template engine</td>
</tr>
<tr>
<td><code>response</code></td>
<td style="text-align: left;">Psr\Http\Message\ResponseInterface</td>
<td style="text-align: left;">set a PSR-7 response to send output early</td>
</tr>
</tbody>
</table>
<h3 id="template-engine-registered">template_engine_registered</h3>
<p>this event is triggered before the template is rendered</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>engine</code></td>
<td style="text-align: left;">\Phile\Template\TemplateInterface</td>
<td style="text-align: left;">the raw template engine</td>
</tr>
<tr>
<td><code>data</code></td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">the variables being sent to the template engine</td>
</tr>
</tbody>
</table>
<h3 id="after-render-template">after_render_template</h3>
<p>this event is triggered after the template is rendered</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>templateEngine</code></td>
<td style="text-align: left;">\Phile\Template\TemplateInterface</td>
<td style="text-align: left;">the template engine</td>
</tr>
<tr>
<td><code>output</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the parsed and ready output</td>
</tr>
</tbody>
</table>
<h3 id="after-response-created">after_response_created</h3>
<p>This event is triggered after the response is created with the rendered template.</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response</code></td>
<td style="text-align: left;">Psr\Http\Message\ResponseInterface</td>
<td style="text-align: left;">Response with output</td>
</tr>
</tbody>
</table>
<h3 id="before-read-file-meta">before_read_file_meta</h3>
<p>this event is triggered before the meta data is read and parsed</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rawData</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the unparsed data</td>
</tr>
<tr>
<td><code>meta</code></td>
<td style="text-align: left;">\Phile\Model\Meta</td>
<td style="text-align: left;">the meta model</td>
</tr>
</tbody>
</table>
<h3 id="after-read-file-meta">after_read_file_meta</h3>
<p>this event is triggered after the meta data is read and parsed</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rawData</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the unparsed data</td>
</tr>
<tr>
<td><code>meta</code></td>
<td style="text-align: left;">\Phile\Model\Meta</td>
<td style="text-align: left;">the meta model</td>
</tr>
</tbody>
</table>
<h3 id="before-load-content">before_load_content</h3>
<p>this event is triggered before the content is loaded</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filePath</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the path to the file</td>
</tr>
<tr>
<td><code>page</code></td>
<td style="text-align: left;">\Phile\Model\Page</td>
<td style="text-align: left;">the page model</td>
</tr>
</tbody>
</table>
<h3 id="after-load-content">after_load_content</h3>
<p>this event is triggered after the content is loaded</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filePath</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the path to the file</td>
</tr>
<tr>
<td><code>rawData</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the raw data</td>
</tr>
<tr>
<td><code>page</code></td>
<td style="text-align: left;">\Phile\Model\Page</td>
<td style="text-align: left;">the page model</td>
</tr>
</tbody>
</table>
<h3 id="before-parse-content">before_parse_content</h3>
<p>this event is triggered before the content is parsed</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>content</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the raw data</td>
</tr>
<tr>
<td><code>page</code></td>
<td style="text-align: left;">\Phile\Model\Page</td>
<td style="text-align: left;">the page model</td>
</tr>
</tbody>
</table>
<h3 id="after-parse-content">after_parse_content</h3>
<p>this event is triggered after the content is parsed</p>
<table>
<thead>
<tr>
<th>param</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>content</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">the raw data</td>
</tr>
<tr>
<td><code>page</code></td>
<td style="text-align: left;">\Phile\Model\Page</td>
<td style="text-align: left;">the page model</td>
</tr>
</tbody>
</table>


          <p class="info">
              <a href="https://github.com/PhileCMS/Phile/wiki/%5BPLUGIN%5D-Event-System">
                  Edit the source page on github…
              </a>
          </p>
        </div>

    </section>
  </div>
</div>

<div class="clearfix"></div>
<footer class="section-1">
  <div class="grid">
    <div class="col-1-2">
      <h3>
        <a href="https://github.com/orgs/PhileCMS/people">
          Core Authors
        </a>
      </h3>
      <ul>
        <li>
          <a href="https://github.com/james2doyle" target="_blank">
            James Doyle - great ideas, code a lot of plugins and worked on the
            core
          </a>
        </li>
        <li>
          <a href="https://github.com/NeoBlack" target="_blank">
            Frank Nägler - refactoring of the core and introducing OOP concepts
          </a>
        </li>
        <li>
          <a href="https://github.com/Schlaefer" target="_blank">
            Schlaefer
          </a>
        </li>
      </ul>
    </div>
    <div class="col-1-2 center">
      <p>
        <a href="https://github.com/PhileCMS">
          Hosted on Github. Maintained by the PhileCMS community</a>.
      </p>
    </div>
  </div>
</footer>

<script src="../js/script.min.js"></script>
</body>
</html>
